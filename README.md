# OpenTTMD - evaluating ligand pose stability using thermal titration

#### v1.0.1
OpenTTMD - an open source implementation of Thermal Titration Molecular Dynamics (TTMD) with OpenMM. Replicates the protocol as described by
Pavan et al. 2022 (DOI: 10.1021/acs.jcim.2c00995).

Runs sequential MD with increasing temperatures (default, 300 to 450) and scores the ability of the ligand to maintain its native interactions with the target.

Scoring function (interaction fingerprint from ODDT)
$IFPcs = (A·B / ||A||||B||) * -1$

MS coefficient (slope of the straight line that interpolates the first and last points of the “titration profile”):
$MS = (meanIFPcs(T_end) - (-1)) / (T_end - T_start)$

The lower the MS is (between 0 and 1), the stronger is the binding
	
Outputs:
- titration_profile.png (with MS value)
- titration_timeline.png (IFPcs and RMSD evolution over time)
	
Version 1.0.1
  >> instead of N reps, it sequentially performs MD runs within the specified temperature ramp (300k-450k, dT=10K)
  >> uses fingerprint scoring (IFPcs) instead of ContactScore
  >> outputs "titration_profile.png" and "titration_timeline.png" instead of "results.csv"

### Background 
OpenBPMD is an open source implementation of binding pose metadynamics (BPMD). Based on work by [Clark et al, 2016](https://doi.org/10.1021/acs.jctc.6b00201). Primarily built for reranking docked poses out of a list of candidates generated by a docking program. OpenBPMD biases ligands using metadynamics and evaluates how stable they are during the simulation. Recommended to be used in conjunction with [_grand_](https://github.com/essex-lab/grand) to optimise water networks around the ligand before subjecting it to metadynamics.

### Installation & Usage

The dependencies needed for running the scripts can be installed with conda:

```
conda create -n openttmd
conda activate openttmd

conda install -c conda-forge openmm=8.1.2
conda install -c conda-forge mdanalysis
conda install -c conda-forge mdtraj
conda install -c conda-forge parmed
```

Once the dependencies have been installed, running OpenBPMD involves simply running one of the Python scripts. Have a look at the ```examples/``` directory for further instructions on how to run and analyse the OpenBPMD results.

### References

1. A. J. Clark, P. Tiwary, K. Borrelli, S. Feng, E. Miller, R. Abel, R. A. Friesner, B. J. Berne, _J. Chem. Theory Comput._ 2016, 12, 6, 2990–2998, DOI:[https://doi.org/10.1021/acs.jctc.6b00201](https://doi.org/10.1021/acs.jctc.6b00201) 
2. D. Lukauskis, M. L. Samways, S. Aureli, B. P. Cossins, R. D. Taylor, F. L. Gervasio, _J. Chem. Inf. Model._ 2022, 62, 23, 6209–6216, DOI:[https://doi.org/10.1021/acs.jctc.6b00201](https://doi.org/10.1021/acs.jcim.2c01142)
